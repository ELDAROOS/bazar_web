<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BAZAR - –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }

        /* Header styles from main page */
        .header {
            position: fixed;
            top: 0;
            width: 100%;
            background: white;
            padding: 1rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            z-index: 1000;
        }

        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            text-transform: uppercase;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
        }

        .nav-links a {
            text-decoration: none;
            color: black;
            text-transform: uppercase;
            font-size: 0.9rem;
        }

        /* Profile specific styles */
        .profile-container {
            max-width: 1200px;
            margin: 100px auto 40px;
            padding: 0 20px;
        }

        .profile-header {
            display: flex;
            align-items: center;
            margin-bottom: 2rem;
            padding: 2rem;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 2rem;
            font-size: 2rem;
        }

        .profile-info h1 {
            margin-bottom: 0.5rem;
        }

        .profile-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .tab {
            padding: 1rem 2rem;
            background: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .tab.active {
            background: black;
            color: white;
        }

        .tab-content {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #333;
        }

        .form-group input {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }

        .btn {
            padding: 0.8rem 1.5rem;
            background: black;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
        }

        .order-card {
            border: 1px solid #ddd;
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 4px;
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #eee;
        }

        .order-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
        }

        .order-item {
            display: flex;
            gap: 1rem;
        }

        .order-item img {
            width: 80px;
            height: 80px;
            object-fit: cover;
        }

        .settings-section {
            margin-bottom: 2rem;
        }

        .settings-section h3 {
            margin-bottom: 1rem;
        }
    </style>
</head>
<body>
    <header class="header">
        <nav class="nav">
            <div class="logo">
                <a href="/index.html" style="text-decoration: none; color: inherit;">BAZAR</a>
            </div>
            <div class="nav-links">
                <a href="/women-collection.html">–ñ–µ–Ω—â–∏–Ω—ã</a>
                <a href="/men-collection.html">–ú—É–∂—á–∏–Ω—ã</a>
            </div>
        </nav>
    </header>
    

    <div class="profile-container">
        <div class="profile-header">
            <div class="profile-avatar">üë§</div>
            <div class="profile-info">
                <h1 id="userName">–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤</h1>
                <p id="userEmail">ivan@example.com</p>
            </div>
        </div>

        <div class="profile-tabs">
            <button class="tab active" onclick="showTab('personal')">–õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</button>
            <button class="tab" onclick="showTab('orders')">–ú–æ–∏ –∑–∞–∫–∞–∑—ã</button>
            <button class="tab" onclick="showTab('settings')">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
        </div>

        <div class="tab-content" id="personal">
            <h2>–õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h2>
            <form id="profileForm">
                <div class="form-group">
                    <label for="name">–ò–º—è</label>
                    <input type="text" id="name" value="–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤">
                </div>
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" value="ivan@example.com">
                </div>
                <div class="form-group">
                    <label for="phone">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                    <input type="tel" id="phone" value="+7 (999) 123-45-67">
                </div>
                <div class="form-group">
                    <label for="address">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏</label>
                    <input type="text" id="address" value="—É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, –¥. 1, –∫–≤. 1">
                </div>
                <button type="submit" class="btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
            </form>
        </div>

        <div class="tab-content" id="orders" style="display: none;">
            <h2>–ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</h2>
            <div class="order-card">
                <div class="order-header">
                    <div>
                        <strong>–ó–∞–∫–∞–∑ #12345</strong>
                        <p>15 —è–Ω–≤–∞—Ä—è 2025</p>
                    </div>
                    <div>
                        <span>–°—Ç–∞—Ç—É—Å: –î–æ—Å—Ç–∞–≤–ª–µ–Ω</span>
                        <p>–°—É–º–º–∞: 12 999 ‚ÇΩ</p>
                    </div>
                </div>
                <div class="order-items">
                    <div class="order-item">
                        <img src="/api/placeholder/80/80" alt="–¢–æ–≤–∞—Ä">
                        <div>
                            <p>–ü–ª–∞—Ç—å–µ –ª–µ—Ç–Ω–µ–µ</p>
                            <p>4 999 ‚ÇΩ</p>
                        </div>
                    </div>
                    <div class="order-item">
                        <img src="/api/placeholder/80/80" alt="–¢–æ–≤–∞—Ä">
                        <div>
                            <p>–î–∂–∏–Ω—Å—ã</p>
                            <p>7 999 ‚ÇΩ</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-content" id="settings" style="display: none;">
            <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–∫–∫–∞—É–Ω—Ç–∞</h2>
            <div class="settings-section">
                <h3>–°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</h3>
                <form id="passwordForm">
                    <div class="form-group">
                        <label for="current-password">–¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å</label>
                        <input type="password" id="current-password">
                    </div>
                    <div class="form-group">
                        <label for="new-password">–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
                        <input type="password" id="new-password">
                    </div>
                    <div class="form-group">
                        <label for="confirm-new-password">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
                        <input type="password" id="confirm-new-password">
                    </div>
                    <button type="submit" class="btn">–°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ –∏–∑ localStorage –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –µ–≥–æ –Ω–∞–ª–∏—á–∏—è
        function getToken() {
            const token = localStorage.getItem('jwtToken');
            if (!token) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É.');
            }
            console.log("–¢–æ–∫–µ–Ω –∏–∑ localStorage:", token);
            console.log("–í–µ—Å—å localStorage:", localStorage);
            return token;
        }
    
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è ID –∏–∑ JWT
        function getUserIdFromJWT(token) {
            if (!token) return null;
    
            const payload = token.split('.')[1]; // –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –∏–∑ JWT (–≤—Ç–æ—Ä–∞—è —á–∞—Å—Ç—å –ø–æ—Å–ª–µ —Ç–æ—á–∫–∏)
            const decoded = atob(payload); // –î–µ–∫–æ–¥–∏—Ä—É–µ–º –∏–∑ base64
            const user = JSON.parse(decoded); // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Å—Ç—Ä–æ–∫—É –≤ –æ–±—ä–µ–∫—Ç
    
            return user.id; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º ID –∏–∑ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
        }
    
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ GET –∑–∞–ø—Ä–æ—Å–∞ –ø–æ URI
        function fetchUserProfile() {
            const token = getToken();
            if (!token) return;
    
            const userId = getUserIdFromJWT(token);
            if (!userId) {
                alert('–û—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.');
                return;
            }
    
            // –§–æ—Ä–º–∏—Ä—É–µ–º URI —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º ID –∏–∑ —Ç–æ–∫–µ–Ω–∞
            const uri = `http://localhost:8080/api/profile/${userId}`;
    
            // –õ–æ–≥–∏—Ä—É–µ–º –∞–¥—Ä–µ—Å –∑–∞–ø—Ä–æ—Å–∞
            console.log("–ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ –∞–¥—Ä–µ—Å:", uri);
    
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º GET –∑–∞–ø—Ä–æ—Å
            fetch(uri, {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${token}` // –î–æ–±–∞–≤–ª—è–µ–º JWT –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∏
                }
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('userName').textContent = data.name;
                document.getElementById('userEmail').textContent = data.email;
                // –ú–æ–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
            });
        }
    
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏
        function showTab(tabName) {
            const tabs = document.querySelectorAll('.tab');
            const contents = document.querySelectorAll('.tab-content');
    
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å –≤—Å–µ—Ö –≤–∫–ª–∞–¥–æ–∫ –∏ —Å–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            tabs.forEach(tab => tab.classList.remove('active'));
            contents.forEach(content => content.style.display = 'none');
    
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç
            document.querySelector(`.tab[onclick="showTab('${tabName}')"]`).classList.add('active');
            document.getElementById(tabName).style.display = 'block';
        }
    
        // –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = function() {
            fetchUserProfile();
            // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤–∫–ª–∞–¥–∫—É "–õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"
            showTab('personal');
        };
    </script>
    
    
    
</body>
</html>
